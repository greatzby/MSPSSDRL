[2026-01-29 09:55:02,156][INFO] Q-learning training started.
[2026-01-29 09:55:02,156][INFO] Output directory: out_qlearning/ql_20260129_095502
[2026-01-29 09:55:02,156][INFO] Reward type: process
[2026-01-29 09:55:02,160][INFO] Resolved model configuration: {"vocab_size": 92, "block_size": 32, "n_layer": 1, "n_head": 1, "n_embd": 92, "dropout": 0.0, "bias": false}
[2026-01-29 09:55:02,415][INFO] Target network enabled: EMA=0.9950, sync_interval=0
[2026-01-29 09:55:02,415][INFO] KL disabled.
[2026-01-29 09:55:03,290][INFO] Loaded 1544 unique (source, target) pairs for Q-learning training.
[2026-01-29 09:55:03,291][WARNING] max_rollout_steps=32 exceeds block_size=32; truncated to 28.
[2026-01-29 09:55:11,911][INFO] Iter     50 | loss=28.8046 | td_err=4.1470 | kl=0.0000 | temp=0.006 | eps=0.000 | success=0.969 | hit=0.969 | stage2=0.875 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.425 | avg_path=4.28 | valid_steps=3.28
[2026-01-29 09:55:20,196][INFO] Iter    100 | loss=16.3975 | td_err=3.2380 | kl=0.0000 | temp=0.013 | eps=0.000 | success=0.656 | hit=0.656 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.344 | invalid_tok=0.000 | avg_ep_reward=0.808 | avg_path=4.69 | valid_steps=3.34
[2026-01-29 09:55:28,815][INFO] Iter    150 | loss=13.0555 | td_err=2.8175 | kl=0.0000 | temp=0.019 | eps=0.000 | success=0.406 | hit=0.406 | stage2=0.812 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.469 | invalid_tok=0.000 | avg_ep_reward=0.355 | avg_path=5.28 | valid_steps=3.81
[2026-01-29 09:55:38,274][INFO] Iter    200 | loss=9.5861 | td_err=2.4119 | kl=0.0000 | temp=0.025 | eps=0.000 | success=0.406 | hit=0.406 | stage2=0.938 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.562 | invalid_tok=0.000 | avg_ep_reward=0.394 | avg_path=6.69 | valid_steps=5.12
[2026-01-29 09:55:48,707][INFO] Iter    250 | loss=7.5765 | td_err=2.1063 | kl=0.0000 | temp=0.031 | eps=0.000 | success=0.312 | hit=0.312 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.688 | invalid_tok=0.000 | avg_ep_reward=0.175 | avg_path=6.03 | valid_steps=4.34
[2026-01-29 09:55:59,363][INFO] Iter    300 | loss=4.8538 | td_err=1.6659 | kl=0.0000 | temp=0.037 | eps=0.000 | success=0.312 | hit=0.312 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.625 | invalid_tok=0.000 | avg_ep_reward=0.266 | avg_path=6.66 | valid_steps=5.03
[2026-01-29 09:56:10,202][INFO] Iter    350 | loss=3.2875 | td_err=1.3309 | kl=0.0000 | temp=0.044 | eps=0.000 | success=0.062 | hit=0.062 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.844 | invalid_tok=0.000 | avg_ep_reward=-0.148 | avg_path=7.91 | valid_steps=6.06
[2026-01-29 09:56:21,614][INFO] Iter    400 | loss=2.0355 | td_err=1.0969 | kl=0.0000 | temp=0.050 | eps=0.000 | success=0.062 | hit=0.062 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.844 | invalid_tok=0.000 | avg_ep_reward=-0.123 | avg_path=8.03 | valid_steps=6.19
[2026-01-29 09:56:33,307][INFO] Iter    450 | loss=1.8814 | td_err=0.9247 | kl=0.0000 | temp=0.056 | eps=0.000 | success=0.062 | hit=0.062 | stage2=0.875 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.938 | invalid_tok=0.000 | avg_ep_reward=-0.125 | avg_path=8.41 | valid_steps=6.47
[2026-01-29 09:56:45,262][INFO] Iter    500 | loss=1.6186 | td_err=0.8736 | kl=0.0000 | temp=0.062 | eps=0.000 | success=0.031 | hit=0.031 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.906 | invalid_tok=0.062 | avg_ep_reward=-0.342 | avg_path=7.91 | valid_steps=6.00
[2026-01-29 09:56:57,497][INFO] Iter    550 | loss=1.0341 | td_err=0.7186 | kl=0.0000 | temp=0.069 | eps=0.000 | success=0.094 | hit=0.094 | stage2=0.719 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.844 | invalid_tok=0.062 | avg_ep_reward=-0.277 | avg_path=8.03 | valid_steps=6.19
[2026-01-29 09:57:10,005][INFO] Iter    600 | loss=0.8976 | td_err=0.7052 | kl=0.0000 | temp=0.075 | eps=0.000 | success=0.188 | hit=0.188 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.812 | invalid_tok=0.000 | avg_ep_reward=-0.097 | avg_path=8.38 | valid_steps=6.56
[2026-01-29 09:57:22,588][INFO] Iter    650 | loss=0.9486 | td_err=0.6486 | kl=0.0000 | temp=0.081 | eps=0.000 | success=0.188 | hit=0.188 | stage2=0.688 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.688 | invalid_tok=0.062 | avg_ep_reward=-0.119 | avg_path=8.28 | valid_steps=6.59
[2026-01-29 09:57:35,281][INFO] Iter    700 | loss=0.2901 | td_err=0.4002 | kl=0.0000 | temp=0.087 | eps=0.000 | success=0.125 | hit=0.125 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.875 | invalid_tok=0.000 | avg_ep_reward=-0.041 | avg_path=8.91 | valid_steps=7.03
[2026-01-29 09:57:48,201][INFO] Iter    750 | loss=0.2767 | td_err=0.3676 | kl=0.0000 | temp=0.094 | eps=0.000 | success=0.156 | hit=0.156 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.531 | invalid_tok=0.000 | avg_ep_reward=0.045 | avg_path=8.66 | valid_steps=7.12
[2026-01-29 09:58:01,245][INFO] Iter    800 | loss=0.4518 | td_err=0.4294 | kl=0.0000 | temp=0.100 | eps=0.000 | success=0.219 | hit=0.219 | stage2=0.750 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.688 | invalid_tok=0.000 | avg_ep_reward=-0.066 | avg_path=8.34 | valid_steps=6.66
[2026-01-29 09:58:14,383][INFO] Iter    850 | loss=0.2736 | td_err=0.3650 | kl=0.0000 | temp=0.106 | eps=0.000 | success=0.188 | hit=0.188 | stage2=0.969 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.531 | invalid_tok=0.000 | avg_ep_reward=0.227 | avg_path=9.50 | valid_steps=7.97
[2026-01-29 09:58:27,777][INFO] Iter    900 | loss=0.2949 | td_err=0.3491 | kl=0.0000 | temp=0.113 | eps=0.000 | success=0.219 | hit=0.219 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.688 | invalid_tok=0.000 | avg_ep_reward=0.012 | avg_path=9.00 | valid_steps=7.31
[2026-01-29 09:58:41,729][INFO] Iter    950 | loss=0.2864 | td_err=0.3684 | kl=0.0000 | temp=0.119 | eps=0.000 | success=0.188 | hit=0.188 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.438 | invalid_tok=0.031 | avg_ep_reward=0.084 | avg_path=9.19 | valid_steps=7.75
[2026-01-29 09:58:55,930][INFO] Iter   1000 | loss=0.2747 | td_err=0.3356 | kl=0.0000 | temp=0.125 | eps=0.000 | success=0.156 | hit=0.156 | stage2=0.938 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.375 | invalid_tok=0.000 | avg_ep_reward=0.088 | avg_path=9.66 | valid_steps=8.28
[2026-01-29 09:59:01,272][INFO] ---- Evaluation at iter 1000 ----
[2026-01-29 09:59:01,272][INFO]   S1->S2: 0.00% (0 / 89)
[2026-01-29 09:59:01,272][INFO]   S2->S3: 3.30% (3 / 91)
[2026-01-29 09:59:01,272][INFO]   S1->S3: 4.44% (6 / 135)
[2026-01-29 09:59:01,272][INFO]   overall: 2.86% (9 / 315)
[2026-01-29 09:59:16,055][INFO] Iter   1050 | loss=0.1209 | td_err=0.2414 | kl=0.0000 | temp=0.131 | eps=0.000 | success=0.188 | hit=0.188 | stage2=1.000 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.281 | invalid_tok=0.000 | avg_ep_reward=0.192 | avg_path=10.34 | valid_steps=9.06
[2026-01-29 09:59:30,920][INFO] Iter   1100 | loss=0.1144 | td_err=0.2366 | kl=0.0000 | temp=0.138 | eps=0.000 | success=0.188 | hit=0.188 | stage2=0.938 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.281 | invalid_tok=0.000 | avg_ep_reward=0.142 | avg_path=10.78 | valid_steps=9.50
[2026-01-29 09:59:46,074][INFO] Iter   1150 | loss=0.1782 | td_err=0.2725 | kl=0.0000 | temp=0.144 | eps=0.000 | success=0.188 | hit=0.188 | stage2=0.938 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.250 | invalid_tok=0.000 | avg_ep_reward=0.178 | avg_path=10.41 | valid_steps=9.16
[2026-01-29 10:00:01,311][INFO] Iter   1200 | loss=0.1036 | td_err=0.2131 | kl=0.0000 | temp=0.150 | eps=0.000 | success=0.250 | hit=0.250 | stage2=0.969 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.156 | invalid_tok=0.000 | avg_ep_reward=0.252 | avg_path=10.69 | valid_steps=9.53
[2026-01-29 10:00:16,813][INFO] Iter   1250 | loss=0.1115 | td_err=0.2190 | kl=0.0000 | temp=0.156 | eps=0.000 | success=0.219 | hit=0.219 | stage2=1.000 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.255 | avg_path=11.12 | valid_steps=10.09
[2026-01-29 10:00:32,569][INFO] Iter   1300 | loss=0.1994 | td_err=0.2360 | kl=0.0000 | temp=0.163 | eps=0.000 | success=0.250 | hit=0.250 | stage2=0.938 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.094 | invalid_tok=0.000 | avg_ep_reward=0.348 | avg_path=10.56 | valid_steps=9.47
[2026-01-29 10:00:48,498][INFO] Iter   1350 | loss=0.0939 | td_err=0.2052 | kl=0.0000 | temp=0.169 | eps=0.000 | success=0.406 | hit=0.406 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.125 | invalid_tok=0.000 | avg_ep_reward=0.403 | avg_path=10.25 | valid_steps=9.12
[2026-01-29 10:01:04,545][INFO] Iter   1400 | loss=0.3181 | td_err=0.2980 | kl=0.0000 | temp=0.175 | eps=0.000 | success=0.188 | hit=0.188 | stage2=0.875 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.188 | invalid_tok=0.000 | avg_ep_reward=0.188 | avg_path=10.72 | valid_steps=9.53
[2026-01-29 10:01:21,281][INFO] Iter   1450 | loss=0.5262 | td_err=0.2686 | kl=0.0000 | temp=0.181 | eps=0.000 | success=0.344 | hit=0.344 | stage2=0.938 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.188 | invalid_tok=0.000 | avg_ep_reward=0.475 | avg_path=10.88 | valid_steps=9.69
[2026-01-29 10:01:38,435][INFO] Iter   1500 | loss=0.0817 | td_err=0.1941 | kl=0.0000 | temp=0.188 | eps=0.000 | success=0.438 | hit=0.438 | stage2=0.969 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.094 | invalid_tok=0.000 | avg_ep_reward=0.605 | avg_path=11.12 | valid_steps=10.03
[2026-01-29 10:01:55,337][INFO] Iter   1550 | loss=0.0746 | td_err=0.1830 | kl=0.0000 | temp=0.194 | eps=0.000 | success=0.344 | hit=0.344 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.125 | invalid_tok=0.000 | avg_ep_reward=0.347 | avg_path=11.44 | valid_steps=10.31
[2026-01-29 10:02:12,485][INFO] Iter   1600 | loss=0.0706 | td_err=0.1689 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.250 | hit=0.250 | stage2=0.938 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.420 | avg_path=12.56 | valid_steps=11.53
[2026-01-29 10:02:29,889][INFO] Iter   1650 | loss=0.1725 | td_err=0.1818 | kl=0.0000 | temp=0.206 | eps=0.000 | success=0.281 | hit=0.281 | stage2=0.938 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.188 | invalid_tok=0.000 | avg_ep_reward=0.344 | avg_path=11.19 | valid_steps=10.00
[2026-01-29 10:02:47,182][INFO] Iter   1700 | loss=0.0571 | td_err=0.1619 | kl=0.0000 | temp=0.212 | eps=0.000 | success=0.344 | hit=0.344 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.156 | invalid_tok=0.000 | avg_ep_reward=0.611 | avg_path=12.31 | valid_steps=11.16
[2026-01-29 10:03:04,857][INFO] Iter   1750 | loss=0.0475 | td_err=0.1416 | kl=0.0000 | temp=0.219 | eps=0.000 | success=0.344 | hit=0.344 | stage2=1.000 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=12.53 | valid_steps=11.53
[2026-01-29 10:03:22,363][INFO] Iter   1800 | loss=0.0398 | td_err=0.1253 | kl=0.0000 | temp=0.225 | eps=0.000 | success=0.312 | hit=0.312 | stage2=0.969 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.125 | invalid_tok=0.000 | avg_ep_reward=0.537 | avg_path=13.75 | valid_steps=12.62
[2026-01-29 10:03:40,199][INFO] Iter   1850 | loss=0.0912 | td_err=0.1608 | kl=0.0000 | temp=0.231 | eps=0.000 | success=0.531 | hit=0.531 | stage2=0.969 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.897 | avg_path=11.69 | valid_steps=10.69
[2026-01-29 10:03:57,966][INFO] Iter   1900 | loss=0.0357 | td_err=0.1240 | kl=0.0000 | temp=0.237 | eps=0.000 | success=0.406 | hit=0.406 | stage2=0.969 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.062 | invalid_tok=0.000 | avg_ep_reward=0.569 | avg_path=12.44 | valid_steps=11.38
[2026-01-29 10:04:15,756][INFO] Iter   1950 | loss=0.0379 | td_err=0.1263 | kl=0.0000 | temp=0.244 | eps=0.000 | success=0.219 | hit=0.219 | stage2=0.938 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.094 | invalid_tok=0.000 | avg_ep_reward=0.311 | avg_path=13.91 | valid_steps=12.81
[2026-01-29 10:04:33,777][INFO] Iter   2000 | loss=0.0951 | td_err=0.1491 | kl=0.0000 | temp=0.250 | eps=0.000 | success=0.500 | hit=0.500 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.789 | avg_path=10.94 | valid_steps=9.91
[2026-01-29 10:04:39,103][INFO] ---- Evaluation at iter 2000 ----
[2026-01-29 10:04:39,104][INFO]   S1->S2: 0.00% (0 / 89)
[2026-01-29 10:04:39,104][INFO]   S2->S3: 26.37% (24 / 91)
[2026-01-29 10:04:39,104][INFO]   S1->S3: 20.74% (28 / 135)
[2026-01-29 10:04:39,104][INFO]   overall: 16.51% (52 / 315)
[2026-01-29 10:04:39,108][INFO] Saved Q-learning checkpoint to out_qlearning/ql_20260129_095502/ckpt_ql_2000.pt
[2026-01-29 10:04:57,252][INFO] Iter   2050 | loss=0.1986 | td_err=0.1578 | kl=0.0000 | temp=0.256 | eps=0.000 | success=0.438 | hit=0.438 | stage2=1.000 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.741 | avg_path=12.72 | valid_steps=11.72
[2026-01-29 10:05:14,905][INFO] Iter   2100 | loss=0.0263 | td_err=0.1158 | kl=0.0000 | temp=0.263 | eps=0.000 | success=0.438 | hit=0.438 | stage2=0.969 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.734 | avg_path=12.03 | valid_steps=11.03
[2026-01-29 10:05:32,719][INFO] Iter   2150 | loss=0.0226 | td_err=0.1011 | kl=0.0000 | temp=0.269 | eps=0.000 | success=0.250 | hit=0.250 | stage2=1.000 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.498 | avg_path=13.97 | valid_steps=12.94
[2026-01-29 10:05:50,581][INFO] Iter   2200 | loss=0.0277 | td_err=0.1063 | kl=0.0000 | temp=0.275 | eps=0.000 | success=0.281 | hit=0.281 | stage2=0.938 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.525 | avg_path=13.72 | valid_steps=12.72
[2026-01-29 10:06:08,095][INFO] Iter   2250 | loss=0.0217 | td_err=0.1019 | kl=0.0000 | temp=0.281 | eps=0.000 | success=0.375 | hit=0.375 | stage2=0.938 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.062 | invalid_tok=0.000 | avg_ep_reward=0.512 | avg_path=10.53 | valid_steps=9.47
[2026-01-29 10:06:25,603][INFO] Iter   2300 | loss=0.0623 | td_err=0.1139 | kl=0.0000 | temp=0.287 | eps=0.000 | success=0.250 | hit=0.250 | stage2=0.969 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.094 | invalid_tok=0.000 | avg_ep_reward=0.420 | avg_path=12.91 | valid_steps=11.81
[2026-01-29 10:06:42,953][INFO] Iter   2350 | loss=0.0316 | td_err=0.1078 | kl=0.0000 | temp=0.294 | eps=0.000 | success=0.406 | hit=0.406 | stage2=0.938 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.062 | invalid_tok=0.000 | avg_ep_reward=0.603 | avg_path=11.59 | valid_steps=10.53
[2026-01-29 10:07:00,098][INFO] Iter   2400 | loss=0.4580 | td_err=0.2274 | kl=0.0000 | temp=0.300 | eps=0.000 | success=0.438 | hit=0.438 | stage2=0.875 | first_src=0.000 | first_valid=0.938 | invalid_edge=0.062 | invalid_tok=0.000 | avg_ep_reward=0.800 | avg_path=10.84 | valid_steps=9.78
[2026-01-29 10:07:16,815][INFO] Iter   2450 | loss=0.0330 | td_err=0.1110 | kl=0.0000 | temp=0.306 | eps=0.000 | success=0.344 | hit=0.344 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.556 | avg_path=11.66 | valid_steps=10.66
[2026-01-29 10:07:33,800][INFO] Iter   2500 | loss=0.0264 | td_err=0.1073 | kl=0.0000 | temp=0.312 | eps=0.000 | success=0.438 | hit=0.438 | stage2=0.938 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.094 | invalid_tok=0.000 | avg_ep_reward=0.745 | avg_path=10.97 | valid_steps=9.88
[2026-01-29 10:07:50,522][INFO] Iter   2550 | loss=0.0531 | td_err=0.1075 | kl=0.0000 | temp=0.319 | eps=0.000 | success=0.281 | hit=0.281 | stage2=0.938 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.480 | avg_path=12.25 | valid_steps=11.22
[2026-01-29 10:08:07,580][INFO] Iter   2600 | loss=0.0407 | td_err=0.0950 | kl=0.0000 | temp=0.325 | eps=0.000 | success=0.250 | hit=0.250 | stage2=0.969 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.125 | invalid_tok=0.000 | avg_ep_reward=0.375 | avg_path=12.31 | valid_steps=11.19
[2026-01-29 10:08:24,438][INFO] Iter   2650 | loss=0.0285 | td_err=0.1034 | kl=0.0000 | temp=0.331 | eps=0.000 | success=0.344 | hit=0.344 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.062 | invalid_tok=0.000 | avg_ep_reward=0.466 | avg_path=11.09 | valid_steps=10.03
[2026-01-29 10:08:40,861][INFO] Iter   2700 | loss=0.0757 | td_err=0.1309 | kl=0.0000 | temp=0.338 | eps=0.000 | success=0.375 | hit=0.375 | stage2=0.938 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.689 | avg_path=11.75 | valid_steps=10.72
[2026-01-29 10:08:57,477][INFO] Iter   2750 | loss=0.0110 | td_err=0.0727 | kl=0.0000 | temp=0.344 | eps=0.000 | success=0.531 | hit=0.531 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.897 | avg_path=9.81 | valid_steps=8.81
[2026-01-29 10:09:13,998][INFO] Iter   2800 | loss=0.0110 | td_err=0.0752 | kl=0.0000 | temp=0.350 | eps=0.000 | success=0.469 | hit=0.469 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.770 | avg_path=10.34 | valid_steps=9.31
[2026-01-29 10:09:30,438][INFO] Iter   2850 | loss=0.0123 | td_err=0.0741 | kl=0.0000 | temp=0.356 | eps=0.000 | success=0.375 | hit=0.375 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.875 | avg_path=11.62 | valid_steps=10.62
[2026-01-29 10:09:47,103][INFO] Iter   2900 | loss=0.0135 | td_err=0.0796 | kl=0.0000 | temp=0.362 | eps=0.000 | success=0.500 | hit=0.500 | stage2=0.938 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.931 | avg_path=10.62 | valid_steps=9.62
[2026-01-29 10:10:03,125][INFO] Iter   2950 | loss=0.0151 | td_err=0.0819 | kl=0.0000 | temp=0.369 | eps=0.000 | success=0.406 | hit=0.406 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.897 | avg_path=11.50 | valid_steps=10.50
[2026-01-29 10:10:19,155][INFO] Iter   3000 | loss=0.0113 | td_err=0.0678 | kl=0.0000 | temp=0.375 | eps=0.000 | success=0.156 | hit=0.156 | stage2=0.906 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.544 | avg_path=11.84 | valid_steps=10.84
[2026-01-29 10:10:24,502][INFO] ---- Evaluation at iter 3000 ----
[2026-01-29 10:10:24,503][INFO]   S1->S2: 0.00% (0 / 89)
[2026-01-29 10:10:24,503][INFO]   S2->S3: 39.56% (36 / 91)
[2026-01-29 10:10:24,503][INFO]   S1->S3: 36.30% (49 / 135)
[2026-01-29 10:10:24,503][INFO]   overall: 26.98% (85 / 315)
[2026-01-29 10:10:40,952][INFO] Iter   3050 | loss=0.0201 | td_err=0.0738 | kl=0.0000 | temp=0.381 | eps=0.000 | success=0.469 | hit=0.469 | stage2=0.938 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.041 | avg_path=11.38 | valid_steps=10.38
[2026-01-29 10:10:56,997][INFO] Iter   3100 | loss=0.0095 | td_err=0.0663 | kl=0.0000 | temp=0.388 | eps=0.000 | success=0.469 | hit=0.469 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.922 | avg_path=10.19 | valid_steps=9.19
[2026-01-29 10:11:13,111][INFO] Iter   3150 | loss=0.0109 | td_err=0.0666 | kl=0.0000 | temp=0.394 | eps=0.000 | success=0.500 | hit=0.500 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.019 | avg_path=10.88 | valid_steps=9.88
[2026-01-29 10:11:28,818][INFO] Iter   3200 | loss=0.0089 | td_err=0.0667 | kl=0.0000 | temp=0.400 | eps=0.000 | success=0.562 | hit=0.562 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=1.052 | avg_path=9.06 | valid_steps=8.03
[2026-01-29 10:11:44,710][INFO] Iter   3250 | loss=0.0095 | td_err=0.0705 | kl=0.0000 | temp=0.406 | eps=0.000 | success=0.406 | hit=0.406 | stage2=0.875 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.866 | avg_path=11.69 | valid_steps=10.69
[2026-01-29 10:12:00,296][INFO] Iter   3300 | loss=0.0069 | td_err=0.0606 | kl=0.0000 | temp=0.412 | eps=0.000 | success=0.688 | hit=0.688 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.316 | avg_path=8.66 | valid_steps=7.66
[2026-01-29 10:12:15,923][INFO] Iter   3350 | loss=0.0061 | td_err=0.0496 | kl=0.0000 | temp=0.419 | eps=0.000 | success=0.500 | hit=0.500 | stage2=0.875 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.997 | avg_path=9.47 | valid_steps=8.47
[2026-01-29 10:12:31,197][INFO] Iter   3400 | loss=0.0063 | td_err=0.0563 | kl=0.0000 | temp=0.425 | eps=0.000 | success=0.469 | hit=0.469 | stage2=0.875 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.931 | avg_path=10.34 | valid_steps=9.34
[2026-01-29 10:12:46,581][INFO] Iter   3450 | loss=0.0091 | td_err=0.0593 | kl=0.0000 | temp=0.431 | eps=0.000 | success=0.562 | hit=0.562 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.103 | avg_path=9.09 | valid_steps=8.09
[2026-01-29 10:13:01,865][INFO] Iter   3500 | loss=0.0049 | td_err=0.0498 | kl=0.0000 | temp=0.438 | eps=0.000 | success=0.438 | hit=0.438 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.875 | avg_path=9.12 | valid_steps=8.12
[2026-01-29 10:13:17,057][INFO] Iter   3550 | loss=0.0067 | td_err=0.0529 | kl=0.0000 | temp=0.444 | eps=0.000 | success=0.562 | hit=0.562 | stage2=0.938 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.147 | avg_path=9.22 | valid_steps=8.22
[2026-01-29 10:13:31,706][INFO] Iter   3600 | loss=0.0040 | td_err=0.0462 | kl=0.0000 | temp=0.450 | eps=0.000 | success=0.531 | hit=0.531 | stage2=0.938 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.188 | avg_path=10.03 | valid_steps=9.03
[2026-01-29 10:13:46,385][INFO] Iter   3650 | loss=0.0074 | td_err=0.0573 | kl=0.0000 | temp=0.456 | eps=0.000 | success=0.625 | hit=0.625 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.175 | avg_path=7.75 | valid_steps=6.75
[2026-01-29 10:14:00,798][INFO] Iter   3700 | loss=0.0055 | td_err=0.0487 | kl=0.0000 | temp=0.463 | eps=0.000 | success=0.531 | hit=0.531 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.084 | avg_path=10.19 | valid_steps=9.19
[2026-01-29 10:14:15,133][INFO] Iter   3750 | loss=0.0105 | td_err=0.0539 | kl=0.0000 | temp=0.469 | eps=0.000 | success=0.688 | hit=0.688 | stage2=0.938 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=1.330 | avg_path=9.34 | valid_steps=8.31
[2026-01-29 10:14:29,297][INFO] Iter   3800 | loss=0.0077 | td_err=0.0549 | kl=0.0000 | temp=0.475 | eps=0.000 | success=0.562 | hit=0.562 | stage2=0.969 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.097 | avg_path=9.72 | valid_steps=8.72
[2026-01-29 10:14:43,353][INFO] Iter   3850 | loss=0.0053 | td_err=0.0489 | kl=0.0000 | temp=0.481 | eps=0.000 | success=0.594 | hit=0.594 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.225 | avg_path=9.41 | valid_steps=8.41
[2026-01-29 10:14:57,288][INFO] Iter   3900 | loss=0.0093 | td_err=0.0595 | kl=0.0000 | temp=0.487 | eps=0.000 | success=0.719 | hit=0.719 | stage2=0.938 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.459 | avg_path=9.38 | valid_steps=8.38
[2026-01-29 10:15:10,872][INFO] Iter   3950 | loss=0.0060 | td_err=0.0519 | kl=0.0000 | temp=0.494 | eps=0.000 | success=0.750 | hit=0.750 | stage2=0.969 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.450 | avg_path=8.88 | valid_steps=7.88
[2026-01-29 10:15:24,276][INFO] Iter   4000 | loss=0.0068 | td_err=0.0576 | kl=0.0000 | temp=0.500 | eps=0.000 | success=0.562 | hit=0.562 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.247 | avg_path=10.22 | valid_steps=9.22
[2026-01-29 10:15:29,602][INFO] ---- Evaluation at iter 4000 ----
[2026-01-29 10:15:29,603][INFO]   S1->S2: 0.00% (0 / 89)
[2026-01-29 10:15:29,603][INFO]   S2->S3: 29.67% (27 / 91)
[2026-01-29 10:15:29,603][INFO]   S1->S3: 42.96% (58 / 135)
[2026-01-29 10:15:29,603][INFO]   overall: 26.98% (85 / 315)
[2026-01-29 10:15:29,607][INFO] Saved Q-learning checkpoint to out_qlearning/ql_20260129_095502/ckpt_ql_4000.pt
[2026-01-29 10:15:42,723][INFO] Iter   4050 | loss=0.0050 | td_err=0.0462 | kl=0.0000 | temp=0.506 | eps=0.000 | success=0.656 | hit=0.656 | stage2=0.875 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.219 | avg_path=6.91 | valid_steps=5.91
[2026-01-29 10:15:55,812][INFO] Iter   4100 | loss=0.0072 | td_err=0.0490 | kl=0.0000 | temp=0.512 | eps=0.000 | success=0.750 | hit=0.750 | stage2=0.875 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.394 | avg_path=7.56 | valid_steps=6.56
[2026-01-29 10:16:08,587][INFO] Iter   4150 | loss=0.0045 | td_err=0.0441 | kl=0.0000 | temp=0.519 | eps=0.000 | success=0.844 | hit=0.844 | stage2=0.938 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.528 | avg_path=7.50 | valid_steps=6.50
[2026-01-29 10:16:21,144][INFO] Iter   4200 | loss=0.0112 | td_err=0.0580 | kl=0.0000 | temp=0.525 | eps=0.000 | success=0.719 | hit=0.719 | stage2=0.938 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.309 | avg_path=8.00 | valid_steps=7.00
[2026-01-29 10:16:33,524][INFO] Iter   4250 | loss=0.0072 | td_err=0.0527 | kl=0.0000 | temp=0.531 | eps=0.000 | success=0.625 | hit=0.625 | stage2=0.875 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=1.242 | avg_path=7.47 | valid_steps=6.44
[2026-01-29 10:16:45,402][INFO] Iter   4300 | loss=0.0108 | td_err=0.0632 | kl=0.0000 | temp=0.537 | eps=0.000 | success=0.781 | hit=0.781 | stage2=0.844 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.425 | avg_path=6.91 | valid_steps=5.91
[2026-01-29 10:16:57,140][INFO] Iter   4350 | loss=0.0067 | td_err=0.0516 | kl=0.0000 | temp=0.544 | eps=0.000 | success=0.781 | hit=0.781 | stage2=0.938 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.500 | avg_path=7.59 | valid_steps=6.59
[2026-01-29 10:17:08,674][INFO] Iter   4400 | loss=0.0098 | td_err=0.0622 | kl=0.0000 | temp=0.550 | eps=0.000 | success=0.656 | hit=0.656 | stage2=0.938 | first_src=0.000 | first_valid=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.209 | avg_path=6.56 | valid_steps=5.56
[2026-01-29 10:17:20,285][INFO] Iter   4450 | loss=0.0045 | td_err=0.0488 | kl=0.0000 | temp=0.556 | eps=0.000 | success=0.781 | hit=0.781 | stage2=1.000 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.491 | avg_path=7.06 | valid_steps=6.06
[2026-01-29 10:17:31,700][INFO] Iter   4500 | loss=0.0116 | td_err=0.0583 | kl=0.0000 | temp=0.562 | eps=0.000 | success=0.719 | hit=0.719 | stage2=0.969 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=1.358 | avg_path=7.22 | valid_steps=6.19
[2026-01-29 10:17:43,063][INFO] Iter   4550 | loss=0.0060 | td_err=0.0531 | kl=0.0000 | temp=0.569 | eps=0.000 | success=0.781 | hit=0.781 | stage2=1.000 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.497 | avg_path=7.69 | valid_steps=6.69
[2026-01-29 10:17:54,515][INFO] Iter   4600 | loss=0.0040 | td_err=0.0455 | kl=0.0000 | temp=0.575 | eps=0.000 | success=0.812 | hit=0.812 | stage2=0.938 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.516 | avg_path=8.16 | valid_steps=7.16
[2026-01-29 10:18:05,965][INFO] Iter   4650 | loss=0.0032 | td_err=0.0391 | kl=0.0000 | temp=0.581 | eps=0.000 | success=0.625 | hit=0.625 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.237 | avg_path=7.38 | valid_steps=6.38
[2026-01-29 10:18:17,401][INFO] Iter   4700 | loss=0.0033 | td_err=0.0411 | kl=0.0000 | temp=0.588 | eps=0.000 | success=0.844 | hit=0.844 | stage2=0.938 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.572 | avg_path=7.00 | valid_steps=6.00
[2026-01-29 10:18:28,953][INFO] Iter   4750 | loss=0.0037 | td_err=0.0417 | kl=0.0000 | temp=0.594 | eps=0.000 | success=0.688 | hit=0.688 | stage2=1.000 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.453 | avg_path=8.84 | valid_steps=7.84
[2026-01-29 10:18:40,479][INFO] Iter   4800 | loss=0.0043 | td_err=0.0469 | kl=0.0000 | temp=0.600 | eps=0.000 | success=0.750 | hit=0.750 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.303 | avg_path=6.47 | valid_steps=5.47
[2026-01-29 10:18:52,122][INFO] Iter   4850 | loss=0.0046 | td_err=0.0423 | kl=0.0000 | temp=0.606 | eps=0.000 | success=0.750 | hit=0.750 | stage2=1.000 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.456 | avg_path=7.50 | valid_steps=6.50
[2026-01-29 10:19:03,514][INFO] Iter   4900 | loss=0.0039 | td_err=0.0392 | kl=0.0000 | temp=0.613 | eps=0.000 | success=0.781 | hit=0.781 | stage2=1.000 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.450 | avg_path=6.97 | valid_steps=5.97
[2026-01-29 10:19:15,100][INFO] Iter   4950 | loss=0.0027 | td_err=0.0375 | kl=0.0000 | temp=0.619 | eps=0.000 | success=0.812 | hit=0.812 | stage2=0.969 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.556 | avg_path=7.31 | valid_steps=6.31
[2026-01-29 10:19:26,461][INFO] Iter   5000 | loss=0.0031 | td_err=0.0381 | kl=0.0000 | temp=0.625 | eps=0.000 | success=0.750 | hit=0.750 | stage2=0.938 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.469 | avg_path=7.81 | valid_steps=6.81
[2026-01-29 10:19:31,792][INFO] ---- Evaluation at iter 5000 ----
[2026-01-29 10:19:31,793][INFO]   S1->S2: 0.00% (0 / 89)
[2026-01-29 10:19:31,793][INFO]   S2->S3: 24.18% (22 / 91)
[2026-01-29 10:19:31,794][INFO]   S1->S3: 29.63% (40 / 135)
[2026-01-29 10:19:31,794][INFO]   overall: 19.68% (62 / 315)
[2026-01-29 10:19:43,112][INFO] Iter   5050 | loss=0.0027 | td_err=0.0334 | kl=0.0000 | temp=0.631 | eps=0.000 | success=0.594 | hit=0.594 | stage2=0.938 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.219 | avg_path=6.78 | valid_steps=5.78
[2026-01-29 10:19:54,463][INFO] Iter   5100 | loss=0.0023 | td_err=0.0316 | kl=0.0000 | temp=0.637 | eps=0.000 | success=0.719 | hit=0.719 | stage2=0.812 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.413 | avg_path=6.78 | valid_steps=5.78
