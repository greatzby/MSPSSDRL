[2026-01-29 09:28:26,052][INFO] Q-learning training started.
[2026-01-29 09:28:26,052][INFO] Output directory: out_qlearning/ql_20260129_092826
[2026-01-29 09:28:26,052][INFO] Reward type: process
[2026-01-29 09:28:26,056][INFO] Resolved model configuration: {"vocab_size": 92, "block_size": 32, "n_layer": 1, "n_head": 1, "n_embd": 92, "dropout": 0.0, "bias": false}
[2026-01-29 09:28:26,301][INFO] KL enabled: coef=0.0500, warmup=0, anneal=12000
[2026-01-29 09:28:27,076][INFO] Loaded 1544 unique (source, target) pairs for Q-learning training.
[2026-01-29 09:28:27,076][WARNING] max_rollout_steps=32 exceeds block_size=32; truncated to 28.
[2026-01-29 09:28:35,942][INFO] Iter     50 | loss=26.4906 | td_err=3.7112 | kl=2.1818 | temp=0.006 | eps=0.000 | success=0.969 | hit=0.969 | stage2=0.875 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.425 | avg_path=4.28 | valid_steps=3.28
[2026-01-29 09:28:44,289][INFO] Iter    100 | loss=12.4543 | td_err=2.6481 | kl=1.6592 | temp=0.013 | eps=0.000 | success=0.375 | hit=0.375 | stage2=0.938 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.625 | invalid_tok=0.000 | avg_ep_reward=0.356 | avg_path=4.62 | valid_steps=3.00
[2026-01-29 09:28:52,690][INFO] Iter    150 | loss=9.6239 | td_err=2.3304 | kl=2.0337 | temp=0.019 | eps=0.000 | success=0.156 | hit=0.156 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.844 | invalid_tok=0.000 | avg_ep_reward=-0.017 | avg_path=5.25 | valid_steps=3.41
[2026-01-29 09:29:01,465][INFO] Iter    200 | loss=7.5307 | td_err=2.0133 | kl=2.0725 | temp=0.025 | eps=0.000 | success=0.156 | hit=0.156 | stage2=0.906 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.750 | invalid_tok=0.000 | avg_ep_reward=0.034 | avg_path=5.31 | valid_steps=3.56
[2026-01-29 09:29:10,587][INFO] Iter    250 | loss=5.3438 | td_err=1.7198 | kl=2.0396 | temp=0.031 | eps=0.000 | success=0.188 | hit=0.188 | stage2=0.875 | first_src=0.000 | first_valid=0.938 | invalid_edge=0.781 | invalid_tok=0.000 | avg_ep_reward=0.139 | avg_path=5.12 | valid_steps=3.34
[2026-01-29 09:29:20,450][INFO] Iter    300 | loss=3.8365 | td_err=1.3382 | kl=2.6140 | temp=0.037 | eps=0.000 | success=0.062 | hit=0.062 | stage2=0.750 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.906 | invalid_tok=0.000 | avg_ep_reward=-0.108 | avg_path=6.16 | valid_steps=4.25
[2026-01-29 09:29:30,229][INFO] Iter    350 | loss=2.4733 | td_err=1.0815 | kl=2.4485 | temp=0.044 | eps=0.000 | success=0.094 | hit=0.094 | stage2=0.781 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.906 | invalid_tok=0.000 | avg_ep_reward=-0.086 | avg_path=6.22 | valid_steps=4.31
[2026-01-29 09:29:40,200][INFO] Iter    400 | loss=1.3471 | td_err=0.8044 | kl=2.5869 | temp=0.050 | eps=0.000 | success=0.094 | hit=0.094 | stage2=0.906 | first_src=0.031 | first_valid=0.969 | invalid_edge=0.875 | invalid_tok=0.000 | avg_ep_reward=-0.006 | avg_path=6.84 | valid_steps=4.97
[2026-01-29 09:29:50,238][INFO] Iter    450 | loss=0.7092 | td_err=0.5401 | kl=2.6838 | temp=0.056 | eps=0.000 | success=0.125 | hit=0.125 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.844 | invalid_tok=0.000 | avg_ep_reward=-0.039 | avg_path=6.31 | valid_steps=4.47
[2026-01-29 09:30:00,335][INFO] Iter    500 | loss=0.4139 | td_err=0.4118 | kl=2.7491 | temp=0.062 | eps=0.000 | success=0.156 | hit=0.156 | stage2=0.719 | first_src=0.000 | first_valid=0.938 | invalid_edge=0.812 | invalid_tok=0.000 | avg_ep_reward=0.006 | avg_path=5.56 | valid_steps=3.75
[2026-01-29 09:30:10,442][INFO] Iter    550 | loss=0.2756 | td_err=0.2706 | kl=2.9029 | temp=0.069 | eps=0.000 | success=0.125 | hit=0.125 | stage2=0.844 | first_src=0.062 | first_valid=0.938 | invalid_edge=0.844 | invalid_tok=0.000 | avg_ep_reward=0.005 | avg_path=6.38 | valid_steps=4.53
[2026-01-29 09:30:20,831][INFO] Iter    600 | loss=0.2544 | td_err=0.2455 | kl=2.6889 | temp=0.075 | eps=0.000 | success=0.375 | hit=0.375 | stage2=0.875 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.562 | invalid_tok=0.000 | avg_ep_reward=0.475 | avg_path=5.84 | valid_steps=4.28
[2026-01-29 09:30:30,951][INFO] Iter    650 | loss=0.2372 | td_err=0.2456 | kl=2.6803 | temp=0.081 | eps=0.000 | success=0.438 | hit=0.438 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.406 | invalid_tok=0.000 | avg_ep_reward=0.489 | avg_path=6.62 | valid_steps=5.22
[2026-01-29 09:30:40,901][INFO] Iter    700 | loss=0.1867 | td_err=0.1992 | kl=2.3454 | temp=0.087 | eps=0.000 | success=0.594 | hit=0.594 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.281 | invalid_tok=0.000 | avg_ep_reward=0.770 | avg_path=6.09 | valid_steps=4.81
[2026-01-29 09:30:50,562][INFO] Iter    750 | loss=0.1653 | td_err=0.1762 | kl=2.3863 | temp=0.094 | eps=0.000 | success=0.594 | hit=0.594 | stage2=0.906 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.219 | invalid_tok=0.000 | avg_ep_reward=0.805 | avg_path=6.03 | valid_steps=4.81
[2026-01-29 09:30:59,835][INFO] Iter    800 | loss=0.1961 | td_err=0.2235 | kl=2.3133 | temp=0.100 | eps=0.000 | success=0.562 | hit=0.562 | stage2=0.750 | first_src=0.000 | first_valid=0.938 | invalid_edge=0.312 | invalid_tok=0.000 | avg_ep_reward=0.756 | avg_path=4.53 | valid_steps=3.22
[2026-01-29 09:31:08,913][INFO] Iter    850 | loss=0.1404 | td_err=0.1613 | kl=2.0456 | temp=0.106 | eps=0.000 | success=0.844 | hit=0.844 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.156 | invalid_tok=0.000 | avg_ep_reward=1.280 | avg_path=4.69 | valid_steps=3.53
[2026-01-29 09:31:17,845][INFO] Iter    900 | loss=0.1389 | td_err=0.1593 | kl=2.0115 | temp=0.113 | eps=0.000 | success=0.688 | hit=0.688 | stage2=0.750 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.250 | invalid_tok=0.000 | avg_ep_reward=0.959 | avg_path=4.78 | valid_steps=3.53
[2026-01-29 09:31:26,418][INFO] Iter    950 | loss=0.1451 | td_err=0.1708 | kl=2.0011 | temp=0.119 | eps=0.000 | success=0.906 | hit=0.906 | stage2=0.656 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=1.373 | avg_path=4.00 | valid_steps=2.97
[2026-01-29 09:31:34,888][INFO] Iter   1000 | loss=0.1402 | td_err=0.1503 | kl=1.8814 | temp=0.125 | eps=0.000 | success=0.750 | hit=0.750 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.062 | invalid_tok=0.000 | avg_ep_reward=1.166 | avg_path=5.00 | valid_steps=3.94
[2026-01-29 09:31:40,071][INFO] ---- Evaluation at iter 1000 ----
[2026-01-29 09:31:40,071][INFO]   S1->S2: 20.22% (18 / 89)
[2026-01-29 09:31:40,071][INFO]   S2->S3: 8.79% (8 / 91)
[2026-01-29 09:31:40,071][INFO]   S1->S3: 25.93% (35 / 135)
[2026-01-29 09:31:40,071][INFO]   overall: 19.37% (61 / 315)
[2026-01-29 09:31:48,495][INFO] Iter   1050 | loss=0.1182 | td_err=0.1304 | kl=1.8826 | temp=0.131 | eps=0.000 | success=0.906 | hit=0.906 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=1.427 | avg_path=4.22 | valid_steps=3.19
[2026-01-29 09:31:56,710][INFO] Iter   1100 | loss=0.1175 | td_err=0.1373 | kl=1.8294 | temp=0.138 | eps=0.000 | success=0.844 | hit=0.844 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.125 | invalid_tok=0.000 | avg_ep_reward=1.309 | avg_path=4.50 | valid_steps=3.38
[2026-01-29 09:32:04,847][INFO] Iter   1150 | loss=0.1342 | td_err=0.1543 | kl=1.9230 | temp=0.144 | eps=0.000 | success=0.938 | hit=0.938 | stage2=0.781 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.469 | avg_path=4.75 | valid_steps=3.75
[2026-01-29 09:32:12,828][INFO] Iter   1200 | loss=0.1180 | td_err=0.1258 | kl=1.8255 | temp=0.150 | eps=0.000 | success=0.844 | hit=0.844 | stage2=0.750 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.062 | invalid_tok=0.000 | avg_ep_reward=1.331 | avg_path=4.12 | valid_steps=3.06
[2026-01-29 09:32:20,893][INFO] Iter   1250 | loss=0.1021 | td_err=0.1174 | kl=1.7045 | temp=0.156 | eps=0.000 | success=0.938 | hit=0.938 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.509 | avg_path=4.22 | valid_steps=3.22
[2026-01-29 09:32:28,974][INFO] Iter   1300 | loss=0.0895 | td_err=0.0983 | kl=1.6221 | temp=0.163 | eps=0.000 | success=0.906 | hit=0.906 | stage2=0.781 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=1.423 | avg_path=4.31 | valid_steps=3.28
[2026-01-29 09:32:37,159][INFO] Iter   1350 | loss=0.1238 | td_err=0.1292 | kl=1.7418 | temp=0.169 | eps=0.000 | success=0.750 | hit=0.750 | stage2=0.781 | first_src=0.000 | first_valid=0.906 | invalid_edge=0.094 | invalid_tok=0.000 | avg_ep_reward=1.136 | avg_path=4.19 | valid_steps=3.09
[2026-01-29 09:32:45,259][INFO] Iter   1400 | loss=0.0974 | td_err=0.0900 | kl=1.7189 | temp=0.175 | eps=0.000 | success=1.000 | hit=1.000 | stage2=0.688 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.525 | avg_path=3.94 | valid_steps=2.94
[2026-01-29 09:32:53,535][INFO] Iter   1450 | loss=0.0972 | td_err=0.1095 | kl=1.6783 | temp=0.181 | eps=0.000 | success=0.938 | hit=0.938 | stage2=0.781 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=1.445 | avg_path=4.38 | valid_steps=3.34
[2026-01-29 09:33:01,608][INFO] Iter   1500 | loss=0.0867 | td_err=0.0957 | kl=1.6213 | temp=0.188 | eps=0.000 | success=0.812 | hit=0.812 | stage2=0.750 | first_src=0.000 | first_valid=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.281 | avg_path=3.69 | valid_steps=2.69
[2026-01-29 09:33:09,575][INFO] Iter   1550 | loss=0.0857 | td_err=0.0876 | kl=1.6106 | temp=0.194 | eps=0.000 | success=0.875 | hit=0.875 | stage2=0.750 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.350 | avg_path=3.88 | valid_steps=2.88
[2026-01-29 09:33:17,727][INFO] Iter   1600 | loss=0.0868 | td_err=0.0993 | kl=1.5868 | temp=0.200 | eps=0.000 | success=0.938 | hit=0.938 | stage2=0.781 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.456 | avg_path=4.75 | valid_steps=3.75
[2026-01-29 09:33:25,795][INFO] Iter   1650 | loss=0.0847 | td_err=0.0947 | kl=1.5955 | temp=0.206 | eps=0.000 | success=0.875 | hit=0.875 | stage2=0.719 | first_src=0.000 | first_valid=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.325 | avg_path=3.62 | valid_steps=2.62
[2026-01-29 09:33:33,891][INFO] Iter   1700 | loss=0.0817 | td_err=0.0843 | kl=1.5775 | temp=0.212 | eps=0.000 | success=0.875 | hit=0.875 | stage2=0.844 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.434 | avg_path=4.41 | valid_steps=3.41
[2026-01-29 09:33:42,006][INFO] Iter   1750 | loss=0.0911 | td_err=0.1103 | kl=1.5602 | temp=0.219 | eps=0.000 | success=0.938 | hit=0.938 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.466 | avg_path=4.03 | valid_steps=3.03
[2026-01-29 09:33:50,045][INFO] Iter   1800 | loss=0.0762 | td_err=0.0958 | kl=1.4232 | temp=0.225 | eps=0.000 | success=0.906 | hit=0.906 | stage2=0.844 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.494 | avg_path=4.84 | valid_steps=3.84
[2026-01-29 09:33:58,281][INFO] Iter   1850 | loss=0.0942 | td_err=0.1037 | kl=1.4921 | temp=0.231 | eps=0.000 | success=0.812 | hit=0.812 | stage2=0.750 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=1.320 | avg_path=4.69 | valid_steps=3.66
[2026-01-29 09:34:06,473][INFO] Iter   1900 | loss=0.0741 | td_err=0.0913 | kl=1.3735 | temp=0.237 | eps=0.000 | success=0.781 | hit=0.781 | stage2=0.906 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.275 | avg_path=4.66 | valid_steps=3.66
[2026-01-29 09:34:14,607][INFO] Iter   1950 | loss=0.0876 | td_err=0.1054 | kl=1.5848 | temp=0.244 | eps=0.000 | success=0.906 | hit=0.906 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.384 | avg_path=3.69 | valid_steps=2.69
[2026-01-29 09:34:22,786][INFO] Iter   2000 | loss=0.0733 | td_err=0.0769 | kl=1.4978 | temp=0.250 | eps=0.000 | success=0.938 | hit=0.938 | stage2=0.719 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.459 | avg_path=4.16 | valid_steps=3.16
[2026-01-29 09:34:27,927][INFO] ---- Evaluation at iter 2000 ----
[2026-01-29 09:34:27,928][INFO]   S1->S2: 52.81% (47 / 89)
[2026-01-29 09:34:27,928][INFO]   S2->S3: 47.25% (43 / 91)
[2026-01-29 09:34:27,928][INFO]   S1->S3: 54.07% (73 / 135)
[2026-01-29 09:34:27,928][INFO]   overall: 51.75% (163 / 315)
[2026-01-29 09:34:27,932][INFO] Saved Q-learning checkpoint to out_qlearning/ql_20260129_092826/ckpt_ql_2000.pt
[2026-01-29 09:34:36,215][INFO] Iter   2050 | loss=0.0683 | td_err=0.0693 | kl=1.4175 | temp=0.256 | eps=0.000 | success=0.844 | hit=0.844 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.384 | avg_path=4.25 | valid_steps=3.25
[2026-01-29 09:34:44,391][INFO] Iter   2100 | loss=0.0773 | td_err=0.1047 | kl=1.3673 | temp=0.263 | eps=0.000 | success=0.875 | hit=0.875 | stage2=0.906 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.488 | avg_path=4.69 | valid_steps=3.69
[2026-01-29 09:34:52,638][INFO] Iter   2150 | loss=0.0722 | td_err=0.0955 | kl=1.3870 | temp=0.269 | eps=0.000 | success=1.000 | hit=1.000 | stage2=0.938 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.581 | avg_path=4.56 | valid_steps=3.56
[2026-01-29 09:35:00,993][INFO] Iter   2200 | loss=0.0769 | td_err=0.0936 | kl=1.4604 | temp=0.275 | eps=0.000 | success=0.906 | hit=0.906 | stage2=0.875 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.459 | avg_path=4.38 | valid_steps=3.38
[2026-01-29 09:35:09,149][INFO] Iter   2250 | loss=0.0749 | td_err=0.0900 | kl=1.4119 | temp=0.281 | eps=0.000 | success=0.969 | hit=0.969 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.562 | avg_path=4.03 | valid_steps=3.03
[2026-01-29 09:35:17,519][INFO] Iter   2300 | loss=0.0671 | td_err=0.0791 | kl=1.3705 | temp=0.287 | eps=0.000 | success=0.969 | hit=0.969 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.553 | avg_path=4.44 | valid_steps=3.44
[2026-01-29 09:35:25,686][INFO] Iter   2350 | loss=0.0698 | td_err=0.0906 | kl=1.3591 | temp=0.294 | eps=0.000 | success=0.938 | hit=0.938 | stage2=0.938 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.481 | avg_path=3.94 | valid_steps=2.94
[2026-01-29 09:35:34,074][INFO] Iter   2400 | loss=0.0607 | td_err=0.0720 | kl=1.2892 | temp=0.300 | eps=0.000 | success=0.844 | hit=0.844 | stage2=0.938 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.438 | avg_path=4.78 | valid_steps=3.78
[2026-01-29 09:35:42,447][INFO] Iter   2450 | loss=0.0686 | td_err=0.0840 | kl=1.3777 | temp=0.306 | eps=0.000 | success=0.969 | hit=0.969 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.519 | avg_path=4.03 | valid_steps=3.03
[2026-01-29 09:35:50,841][INFO] Iter   2500 | loss=0.0715 | td_err=0.1037 | kl=1.2933 | temp=0.312 | eps=0.000 | success=0.906 | hit=0.906 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.463 | avg_path=4.34 | valid_steps=3.34
[2026-01-29 09:35:59,128][INFO] Iter   2550 | loss=0.0745 | td_err=0.1121 | kl=1.2726 | temp=0.319 | eps=0.000 | success=0.938 | hit=0.938 | stage2=0.938 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.509 | avg_path=4.59 | valid_steps=3.59
[2026-01-29 09:36:07,365][INFO] Iter   2600 | loss=0.0695 | td_err=0.0998 | kl=1.3381 | temp=0.325 | eps=0.000 | success=0.906 | hit=0.906 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.475 | avg_path=4.03 | valid_steps=3.03
[2026-01-29 09:36:15,656][INFO] Iter   2650 | loss=0.0657 | td_err=0.0849 | kl=1.3345 | temp=0.331 | eps=0.000 | success=0.938 | hit=0.938 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.528 | avg_path=4.59 | valid_steps=3.59
[2026-01-29 09:36:23,980][INFO] Iter   2700 | loss=0.0657 | td_err=0.0907 | kl=1.2988 | temp=0.338 | eps=0.000 | success=0.938 | hit=0.938 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.578 | avg_path=4.59 | valid_steps=3.59
[2026-01-29 09:36:32,416][INFO] Iter   2750 | loss=0.0658 | td_err=0.0914 | kl=1.2837 | temp=0.344 | eps=0.000 | success=0.906 | hit=0.906 | stage2=0.812 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.384 | avg_path=4.25 | valid_steps=3.25
[2026-01-29 09:36:40,508][INFO] Iter   2800 | loss=0.0585 | td_err=0.0797 | kl=1.2066 | temp=0.350 | eps=0.000 | success=0.844 | hit=0.844 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.347 | avg_path=4.38 | valid_steps=3.38
[2026-01-29 09:36:48,826][INFO] Iter   2850 | loss=0.0553 | td_err=0.0726 | kl=1.2043 | temp=0.356 | eps=0.000 | success=0.844 | hit=0.844 | stage2=0.844 | first_src=0.000 | first_valid=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.419 | avg_path=4.66 | valid_steps=3.66
[2026-01-29 09:36:57,177][INFO] Iter   2900 | loss=0.0604 | td_err=0.0918 | kl=1.2081 | temp=0.362 | eps=0.000 | success=0.969 | hit=0.969 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.559 | avg_path=4.75 | valid_steps=3.75
[2026-01-29 09:37:05,350][INFO] Iter   2950 | loss=0.0674 | td_err=0.1028 | kl=1.2321 | temp=0.369 | eps=0.000 | success=0.906 | hit=0.906 | stage2=0.906 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.488 | avg_path=4.47 | valid_steps=3.47
[2026-01-29 09:37:13,531][INFO] Iter   3000 | loss=0.0651 | td_err=0.0986 | kl=1.2582 | temp=0.375 | eps=0.000 | success=1.000 | hit=1.000 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.653 | avg_path=4.09 | valid_steps=3.09
[2026-01-29 09:37:18,653][INFO] ---- Evaluation at iter 3000 ----
[2026-01-29 09:37:18,654][INFO]   S1->S2: 83.15% (74 / 89)
[2026-01-29 09:37:18,654][INFO]   S2->S3: 72.53% (66 / 91)
[2026-01-29 09:37:18,654][INFO]   S1->S3: 79.26% (107 / 135)
[2026-01-29 09:37:18,654][INFO]   overall: 78.41% (247 / 315)
[2026-01-29 09:37:27,118][INFO] Iter   3050 | loss=0.0639 | td_err=0.1031 | kl=1.1994 | temp=0.381 | eps=0.000 | success=0.938 | hit=0.938 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.506 | avg_path=4.94 | valid_steps=3.94
[2026-01-29 09:37:35,350][INFO] Iter   3100 | loss=0.0570 | td_err=0.0860 | kl=1.1952 | temp=0.388 | eps=0.000 | success=0.969 | hit=0.969 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.619 | avg_path=4.53 | valid_steps=3.53
[2026-01-29 09:37:43,604][INFO] Iter   3150 | loss=0.0560 | td_err=0.0783 | kl=1.2039 | temp=0.394 | eps=0.000 | success=0.781 | hit=0.781 | stage2=0.875 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.303 | avg_path=4.38 | valid_steps=3.38
[2026-01-29 09:37:52,004][INFO] Iter   3200 | loss=0.0573 | td_err=0.0863 | kl=1.1693 | temp=0.400 | eps=0.000 | success=0.938 | hit=0.938 | stage2=0.812 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.475 | avg_path=4.00 | valid_steps=3.00
[2026-01-29 09:38:00,285][INFO] Iter   3250 | loss=0.0507 | td_err=0.0680 | kl=1.1311 | temp=0.406 | eps=0.000 | success=0.906 | hit=0.906 | stage2=0.875 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.481 | avg_path=4.84 | valid_steps=3.84
[2026-01-29 09:38:08,690][INFO] Iter   3300 | loss=0.0491 | td_err=0.0705 | kl=1.0956 | temp=0.412 | eps=0.000 | success=0.844 | hit=0.844 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.397 | avg_path=4.19 | valid_steps=3.19
[2026-01-29 09:38:17,028][INFO] Iter   3350 | loss=0.0508 | td_err=0.0795 | kl=1.0968 | temp=0.419 | eps=0.000 | success=1.000 | hit=1.000 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.597 | avg_path=4.47 | valid_steps=3.47
[2026-01-29 09:38:25,488][INFO] Iter   3400 | loss=0.0571 | td_err=0.0901 | kl=1.1797 | temp=0.425 | eps=0.000 | success=0.906 | hit=0.906 | stage2=0.844 | first_src=0.000 | first_valid=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.434 | avg_path=4.25 | valid_steps=3.25
[2026-01-29 09:38:33,869][INFO] Iter   3450 | loss=0.0541 | td_err=0.0790 | kl=1.1714 | temp=0.431 | eps=0.000 | success=0.969 | hit=0.969 | stage2=0.812 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.581 | avg_path=4.66 | valid_steps=3.66
[2026-01-29 09:38:42,088][INFO] Iter   3500 | loss=0.0515 | td_err=0.0736 | kl=1.1652 | temp=0.438 | eps=0.000 | success=0.875 | hit=0.875 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.406 | avg_path=4.12 | valid_steps=3.12
[2026-01-29 09:38:50,397][INFO] Iter   3550 | loss=0.0525 | td_err=0.0820 | kl=1.0952 | temp=0.444 | eps=0.000 | success=0.969 | hit=0.969 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.559 | avg_path=4.62 | valid_steps=3.62
[2026-01-29 09:38:58,806][INFO] Iter   3600 | loss=0.0482 | td_err=0.0773 | kl=1.0566 | temp=0.450 | eps=0.000 | success=0.875 | hit=0.875 | stage2=0.969 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.503 | avg_path=4.84 | valid_steps=3.84
[2026-01-29 09:39:07,273][INFO] Iter   3650 | loss=0.0622 | td_err=0.1026 | kl=1.1707 | temp=0.456 | eps=0.000 | success=0.969 | hit=0.969 | stage2=0.781 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.562 | avg_path=4.41 | valid_steps=3.41
[2026-01-29 09:39:15,550][INFO] Iter   3700 | loss=0.0531 | td_err=0.0875 | kl=1.0885 | temp=0.463 | eps=0.000 | success=0.938 | hit=0.938 | stage2=0.844 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.525 | avg_path=4.38 | valid_steps=3.38
[2026-01-29 09:39:23,873][INFO] Iter   3750 | loss=0.0471 | td_err=0.0785 | kl=1.0556 | temp=0.469 | eps=0.000 | success=0.938 | hit=0.938 | stage2=0.844 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.531 | avg_path=5.06 | valid_steps=4.06
[2026-01-29 09:39:32,312][INFO] Iter   3800 | loss=0.0509 | td_err=0.0874 | kl=1.0382 | temp=0.475 | eps=0.000 | success=0.938 | hit=0.938 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.534 | avg_path=4.53 | valid_steps=3.53
[2026-01-29 09:39:40,708][INFO] Iter   3850 | loss=0.0497 | td_err=0.0867 | kl=1.0562 | temp=0.481 | eps=0.000 | success=0.906 | hit=0.906 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.472 | avg_path=4.50 | valid_steps=3.50
[2026-01-29 09:39:49,052][INFO] Iter   3900 | loss=0.0530 | td_err=0.0938 | kl=1.0143 | temp=0.487 | eps=0.000 | success=0.844 | hit=0.844 | stage2=0.906 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.431 | avg_path=4.91 | valid_steps=3.91
[2026-01-29 09:39:57,365][INFO] Iter   3950 | loss=0.0472 | td_err=0.0843 | kl=1.0086 | temp=0.494 | eps=0.000 | success=0.938 | hit=0.938 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.519 | avg_path=4.50 | valid_steps=3.50
[2026-01-29 09:40:05,824][INFO] Iter   4000 | loss=0.0518 | td_err=0.0960 | kl=1.0416 | temp=0.500 | eps=0.000 | success=0.969 | hit=0.969 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.616 | avg_path=4.81 | valid_steps=3.81
[2026-01-29 09:40:10,957][INFO] ---- Evaluation at iter 4000 ----
[2026-01-29 09:40:10,958][INFO]   S1->S2: 97.75% (87 / 89)
[2026-01-29 09:40:10,958][INFO]   S2->S3: 76.92% (70 / 91)
[2026-01-29 09:40:10,958][INFO]   S1->S3: 78.52% (106 / 135)
[2026-01-29 09:40:10,958][INFO]   overall: 83.49% (263 / 315)
[2026-01-29 09:40:10,962][INFO] Saved Q-learning checkpoint to out_qlearning/ql_20260129_092826/ckpt_ql_4000.pt
[2026-01-29 09:40:19,277][INFO] Iter   4050 | loss=0.0458 | td_err=0.0776 | kl=1.0556 | temp=0.506 | eps=0.000 | success=0.938 | hit=0.938 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.547 | avg_path=4.34 | valid_steps=3.34
[2026-01-29 09:40:27,756][INFO] Iter   4100 | loss=0.0476 | td_err=0.0821 | kl=1.0180 | temp=0.512 | eps=0.000 | success=0.781 | hit=0.781 | stage2=0.844 | first_src=0.000 | first_valid=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.322 | avg_path=4.25 | valid_steps=3.25
[2026-01-29 09:40:35,969][INFO] Iter   4150 | loss=0.0484 | td_err=0.0919 | kl=0.9888 | temp=0.519 | eps=0.000 | success=0.906 | hit=0.906 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.484 | avg_path=4.62 | valid_steps=3.62
[2026-01-29 09:40:44,250][INFO] Iter   4200 | loss=0.0436 | td_err=0.0716 | kl=1.0202 | temp=0.525 | eps=0.000 | success=0.781 | hit=0.781 | stage2=0.844 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.266 | avg_path=4.31 | valid_steps=3.31
[2026-01-29 09:40:52,601][INFO] Iter   4250 | loss=0.0443 | td_err=0.0856 | kl=0.9870 | temp=0.531 | eps=0.000 | success=0.938 | hit=0.938 | stage2=0.812 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.569 | avg_path=4.75 | valid_steps=3.75
[2026-01-29 09:41:00,988][INFO] Iter   4300 | loss=0.0489 | td_err=0.0850 | kl=1.1160 | temp=0.537 | eps=0.000 | success=0.875 | hit=0.875 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.444 | avg_path=4.38 | valid_steps=3.38
[2026-01-29 09:41:09,343][INFO] Iter   4350 | loss=0.0397 | td_err=0.0737 | kl=0.9705 | temp=0.544 | eps=0.000 | success=0.906 | hit=0.906 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.538 | avg_path=5.41 | valid_steps=4.41
[2026-01-29 09:41:17,740][INFO] Iter   4400 | loss=0.0460 | td_err=0.0840 | kl=1.0579 | temp=0.550 | eps=0.000 | success=0.938 | hit=0.938 | stage2=0.938 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.500 | avg_path=3.94 | valid_steps=2.94
[2026-01-29 09:41:26,196][INFO] Iter   4450 | loss=0.0466 | td_err=0.0934 | kl=0.9346 | temp=0.556 | eps=0.000 | success=0.938 | hit=0.938 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.584 | avg_path=5.28 | valid_steps=4.28
[2026-01-29 09:41:34,518][INFO] Iter   4500 | loss=0.0452 | td_err=0.0825 | kl=1.0405 | temp=0.562 | eps=0.000 | success=0.844 | hit=0.844 | stage2=0.938 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.369 | avg_path=4.22 | valid_steps=3.22
[2026-01-29 09:41:42,958][INFO] Iter   4550 | loss=0.0429 | td_err=0.0769 | kl=1.0106 | temp=0.569 | eps=0.000 | success=0.969 | hit=0.969 | stage2=1.000 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.606 | avg_path=4.47 | valid_steps=3.47
[2026-01-29 09:41:51,282][INFO] Iter   4600 | loss=0.0442 | td_err=0.0826 | kl=0.9456 | temp=0.575 | eps=0.000 | success=0.938 | hit=0.938 | stage2=0.906 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.575 | avg_path=4.88 | valid_steps=3.88
[2026-01-29 09:41:59,637][INFO] Iter   4650 | loss=0.0456 | td_err=0.0898 | kl=0.9896 | temp=0.581 | eps=0.000 | success=0.938 | hit=0.938 | stage2=0.750 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.522 | avg_path=4.22 | valid_steps=3.22
[2026-01-29 09:42:07,905][INFO] Iter   4700 | loss=0.0414 | td_err=0.0822 | kl=0.9671 | temp=0.588 | eps=0.000 | success=0.938 | hit=0.938 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.519 | avg_path=4.19 | valid_steps=3.19
[2026-01-29 09:42:16,210][INFO] Iter   4750 | loss=0.0445 | td_err=0.0897 | kl=0.9608 | temp=0.594 | eps=0.000 | success=0.969 | hit=0.969 | stage2=0.938 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.603 | avg_path=4.44 | valid_steps=3.44
[2026-01-29 09:42:24,731][INFO] Iter   4800 | loss=0.0464 | td_err=0.0952 | kl=1.0046 | temp=0.600 | eps=0.000 | success=0.969 | hit=0.969 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.566 | avg_path=4.50 | valid_steps=3.50
[2026-01-29 09:42:33,234][INFO] Iter   4850 | loss=0.0509 | td_err=0.1018 | kl=1.0019 | temp=0.606 | eps=0.000 | success=0.906 | hit=0.906 | stage2=0.969 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.441 | avg_path=4.25 | valid_steps=3.25
[2026-01-29 09:42:41,481][INFO] Iter   4900 | loss=0.0498 | td_err=0.0994 | kl=1.0412 | temp=0.613 | eps=0.000 | success=0.906 | hit=0.906 | stage2=0.969 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.538 | avg_path=4.59 | valid_steps=3.59
[2026-01-29 09:42:50,024][INFO] Iter   4950 | loss=0.0387 | td_err=0.0755 | kl=0.9624 | temp=0.619 | eps=0.000 | success=0.969 | hit=0.969 | stage2=0.969 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.559 | avg_path=4.50 | valid_steps=3.50
[2026-01-29 09:42:58,478][INFO] Iter   5000 | loss=0.0466 | td_err=0.0989 | kl=0.9439 | temp=0.625 | eps=0.000 | success=0.906 | hit=0.906 | stage2=0.906 | first_src=0.000 | first_valid=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.450 | avg_path=4.28 | valid_steps=3.28
[2026-01-29 09:43:03,622][INFO] ---- Evaluation at iter 5000 ----
[2026-01-29 09:43:03,623][INFO]   S1->S2: 98.88% (88 / 89)
[2026-01-29 09:43:03,623][INFO]   S2->S3: 78.02% (71 / 91)
[2026-01-29 09:43:03,623][INFO]   S1->S3: 81.48% (110 / 135)
[2026-01-29 09:43:03,623][INFO]   overall: 85.40% (269 / 315)
[2026-01-29 09:43:12,118][INFO] Iter   5050 | loss=0.0400 | td_err=0.0812 | kl=0.9408 | temp=0.631 | eps=0.000 | success=0.969 | hit=0.969 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.613 | avg_path=4.53 | valid_steps=3.53
[2026-01-29 09:43:20,588][INFO] Iter   5100 | loss=0.0465 | td_err=0.0952 | kl=1.0058 | temp=0.637 | eps=0.000 | success=0.938 | hit=0.938 | stage2=0.812 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.556 | avg_path=4.50 | valid_steps=3.50
[2026-01-29 09:43:28,956][INFO] Iter   5150 | loss=0.0382 | td_err=0.0776 | kl=0.9055 | temp=0.644 | eps=0.000 | success=0.938 | hit=0.938 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.578 | avg_path=4.97 | valid_steps=3.97
[2026-01-29 09:43:37,414][INFO] Iter   5200 | loss=0.0449 | td_err=0.0961 | kl=0.9628 | temp=0.650 | eps=0.000 | success=1.000 | hit=1.000 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.594 | avg_path=4.38 | valid_steps=3.38
[2026-01-29 09:43:45,781][INFO] Iter   5250 | loss=0.0402 | td_err=0.0817 | kl=0.9756 | temp=0.656 | eps=0.000 | success=0.938 | hit=0.938 | stage2=0.844 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.503 | avg_path=3.97 | valid_steps=2.97
[2026-01-29 09:43:54,114][INFO] Iter   5300 | loss=0.0394 | td_err=0.0839 | kl=0.9267 | temp=0.662 | eps=0.000 | success=0.938 | hit=0.938 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.606 | avg_path=5.12 | valid_steps=4.12
[2026-01-29 09:44:02,581][INFO] Iter   5350 | loss=0.0390 | td_err=0.0865 | kl=0.8985 | temp=0.669 | eps=0.000 | success=0.906 | hit=0.906 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.519 | avg_path=4.53 | valid_steps=3.53
[2026-01-29 09:44:10,986][INFO] Iter   5400 | loss=0.0391 | td_err=0.0837 | kl=0.8874 | temp=0.675 | eps=0.000 | success=0.938 | hit=0.938 | stage2=0.844 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.541 | avg_path=4.53 | valid_steps=3.53
[2026-01-29 09:44:19,462][INFO] Iter   5450 | loss=0.0369 | td_err=0.0771 | kl=0.9074 | temp=0.681 | eps=0.000 | success=0.969 | hit=0.969 | stage2=0.906 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.619 | avg_path=4.97 | valid_steps=3.97
[2026-01-29 09:44:27,794][INFO] Iter   5500 | loss=0.0412 | td_err=0.0917 | kl=0.8910 | temp=0.688 | eps=0.000 | success=0.969 | hit=0.969 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.578 | avg_path=5.00 | valid_steps=4.00
[2026-01-29 09:44:36,174][INFO] Iter   5550 | loss=0.0394 | td_err=0.0871 | kl=0.9377 | temp=0.694 | eps=0.000 | success=0.938 | hit=0.938 | stage2=0.875 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.497 | avg_path=4.47 | valid_steps=3.47
[2026-01-29 09:44:44,568][INFO] Iter   5600 | loss=0.0385 | td_err=0.0917 | kl=0.8644 | temp=0.700 | eps=0.000 | success=0.938 | hit=0.938 | stage2=0.906 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.544 | avg_path=4.69 | valid_steps=3.69
[2026-01-29 09:44:53,092][INFO] Iter   5650 | loss=0.0363 | td_err=0.0789 | kl=0.9259 | temp=0.706 | eps=0.000 | success=0.875 | hit=0.875 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.428 | avg_path=4.47 | valid_steps=3.47
[2026-01-29 09:45:01,516][INFO] Iter   5700 | loss=0.0381 | td_err=0.0811 | kl=0.9718 | temp=0.713 | eps=0.000 | success=0.906 | hit=0.906 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.472 | avg_path=4.38 | valid_steps=3.38
[2026-01-29 09:45:09,939][INFO] Iter   5750 | loss=0.0408 | td_err=0.0866 | kl=0.9763 | temp=0.719 | eps=0.000 | success=0.938 | hit=0.938 | stage2=0.969 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.519 | avg_path=4.19 | valid_steps=3.19
[2026-01-29 09:45:18,278][INFO] Iter   5800 | loss=0.0433 | td_err=0.0948 | kl=0.9452 | temp=0.725 | eps=0.000 | success=0.938 | hit=0.938 | stage2=0.875 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.569 | avg_path=4.62 | valid_steps=3.62
[2026-01-29 09:45:26,714][INFO] Iter   5850 | loss=0.0367 | td_err=0.0883 | kl=0.8281 | temp=0.731 | eps=0.000 | success=0.844 | hit=0.844 | stage2=0.906 | first_src=0.000 | first_valid=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.428 | avg_path=4.75 | valid_steps=3.75
[2026-01-29 09:45:35,076][INFO] Iter   5900 | loss=0.0320 | td_err=0.0752 | kl=0.8487 | temp=0.738 | eps=0.000 | success=0.906 | hit=0.906 | stage2=0.969 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.562 | avg_path=5.09 | valid_steps=4.09
[2026-01-29 09:45:43,796][INFO] Iter   5950 | loss=0.0361 | td_err=0.0856 | kl=0.9090 | temp=0.744 | eps=0.000 | success=0.969 | hit=0.969 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.600 | avg_path=4.84 | valid_steps=3.84
[2026-01-29 09:45:52,125][INFO] Iter   6000 | loss=0.0337 | td_err=0.0763 | kl=0.8854 | temp=0.750 | eps=0.000 | success=0.938 | hit=0.938 | stage2=0.844 | first_src=0.000 | first_valid=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.531 | avg_path=4.25 | valid_steps=3.25
[2026-01-29 09:45:57,277][INFO] ---- Evaluation at iter 6000 ----
[2026-01-29 09:45:57,278][INFO]   S1->S2: 97.75% (87 / 89)
[2026-01-29 09:45:57,278][INFO]   S2->S3: 78.02% (71 / 91)
[2026-01-29 09:45:57,278][INFO]   S1->S3: 77.04% (104 / 135)
[2026-01-29 09:45:57,278][INFO]   overall: 83.17% (262 / 315)
[2026-01-29 09:45:57,282][INFO] Saved Q-learning checkpoint to out_qlearning/ql_20260129_092826/ckpt_ql_6000.pt
[2026-01-29 09:46:05,846][INFO] Iter   6050 | loss=0.0354 | td_err=0.0875 | kl=0.8359 | temp=0.756 | eps=0.000 | success=0.969 | hit=0.969 | stage2=0.969 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.659 | avg_path=5.00 | valid_steps=4.00
[2026-01-29 09:46:14,470][INFO] Iter   6100 | loss=0.0410 | td_err=0.0948 | kl=0.9209 | temp=0.762 | eps=0.000 | success=0.938 | hit=0.938 | stage2=0.938 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.553 | avg_path=4.47 | valid_steps=3.47
[2026-01-29 09:46:22,841][INFO] Iter   6150 | loss=0.0339 | td_err=0.0851 | kl=0.8692 | temp=0.769 | eps=0.000 | success=0.875 | hit=0.875 | stage2=0.969 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.428 | avg_path=4.09 | valid_steps=3.09
[2026-01-29 09:46:31,329][INFO] Iter   6200 | loss=0.0414 | td_err=0.1013 | kl=0.9036 | temp=0.775 | eps=0.000 | success=0.906 | hit=0.906 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.472 | avg_path=4.44 | valid_steps=3.44
[2026-01-29 09:46:39,822][INFO] Iter   6250 | loss=0.0328 | td_err=0.0775 | kl=0.8417 | temp=0.781 | eps=0.000 | success=0.906 | hit=0.906 | stage2=0.812 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.547 | avg_path=4.88 | valid_steps=3.88
[2026-01-29 09:46:48,289][INFO] Iter   6300 | loss=0.0349 | td_err=0.0878 | kl=0.8650 | temp=0.787 | eps=0.000 | success=0.938 | hit=0.938 | stage2=0.969 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.587 | avg_path=4.94 | valid_steps=3.94
[2026-01-29 09:46:56,600][INFO] Iter   6350 | loss=0.0323 | td_err=0.0712 | kl=0.8873 | temp=0.794 | eps=0.000 | success=0.844 | hit=0.844 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.419 | avg_path=4.47 | valid_steps=3.47
[2026-01-29 09:47:04,968][INFO] Iter   6400 | loss=0.0278 | td_err=0.0589 | kl=0.8626 | temp=0.800 | eps=0.000 | success=0.812 | hit=0.812 | stage2=0.906 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.344 | avg_path=4.31 | valid_steps=3.31
[2026-01-29 09:47:13,336][INFO] Iter   6450 | loss=0.0427 | td_err=0.1080 | kl=0.8795 | temp=0.806 | eps=0.000 | success=0.969 | hit=0.969 | stage2=0.938 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.591 | avg_path=4.38 | valid_steps=3.38
[2026-01-29 09:47:21,678][INFO] Iter   6500 | loss=0.0313 | td_err=0.0791 | kl=0.8343 | temp=0.812 | eps=0.000 | success=1.000 | hit=1.000 | stage2=0.969 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.741 | avg_path=5.47 | valid_steps=4.47
